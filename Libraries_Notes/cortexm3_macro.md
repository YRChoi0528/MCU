
# cortexm3_macro.h 정리

## 역할 (한 줄 요약)
`cortexm3_macro.h`는 **ARM Cortex-M3 코어 자체와 직접 관련된 저수준 매크로 및 제어 기능을 정의한 헤더**이다.

---

## 이 파일의 성격
이 헤더는 **STM32 주변장치용이 아니라, CPU 코어 자체**를 다룬다.

즉,
- GPIO / RCC / USART 같은 “MCU 기능” ❌
- 인터럽트, 특권 모드, CPU 제어 ⭕️

에 해당한다.

---

## 언제 필요한가
- 인터럽트 전역 Enable/Disable
- 크리티컬 섹션(임계 구역) 제어
- 시스템 레벨 제어 코드 이해
- 스타트업 코드/OS/RTOS 학습 시

일반 실습에서는 **직접 수정할 일은 거의 없고**,  
“무슨 역할을 하는지”를 아는 정도가 적당하다.

---

## 핵심 구성 요소

### 1) 인터럽트 제어 매크로
- 전역 인터럽트 Enable
- 전역 인터럽트 Disable

→ 인터럽트가 **CPU에 전달될 수 있는지**를 제어

---

### 2) 메모리 배리어 / 컴파일러 제어
- 명령 재배치 방지
- 최적화 억제 목적

하드웨어/컴파일러 동작 순서를 강제해야 할 때 사용된다.

---

### 3) CPU 특권 관련 제어
- Thread mode / Handler mode
- 특권/비특권 실행 관련 설정

RTOS나 고급 시스템 코드에서 등장한다.

---

## 예시 (개념적 표현)

```c
DISABLE_IRQ();
// 공유 자원 접근
ENABLE_IRQ();
```
의미:
- 중간에 인터럽트가 끼어들지 못하게 막고
- 작업이 끝난 뒤 다시 허용

---

## 실습 관점 정리
- 대부분의 학부 실습에서는 "존재와 역할만 이해"하면 충분
- 함부로 사용하면 시스템 전체 동작에 영향을 준다
- GPIO/UART 등 문제를 해결하기 위해 해당 파일을 먼저 의심할 일은 거의 없다
