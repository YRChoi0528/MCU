# STM32F103_Pin
> 안내
> 해당 문서는 STM32F103 디바이스 패키지의 핀맵을 정리한다.
> 각 주변장치(GPIO, TIMER, USART 등)에 대한 설명은 이후 해당 챕터에서 각각 다룰 예정이며,
> 이 문서에서는 각 챕터에서 다루지 않는 공통적인 핀의 역할과 하드웨어적 배경만을 간략하게 설명한다.
  
![STM32F103 핀맵](../images/STM32F103_Pin.png)

---

## 디바이스 패키지
→ 특정 MCU 모델이 실제로 출하되는 패키지 사양을 의미한다.
- STM : **STMicroelectronics의 약자**, 제조사를 나타내는 접두어
- 32 : **32-bit 마이크로컨트롤러임을 의미**, ARM 32비트 코어 기반
- F : 제품 라인(Family)을 의미, **F는 범용 MCU 라인 (성능/전력 균형형)** 
  - L : 저전력
  - H : 고성능
  - G : 범용 신세대
- 103 : 세부 제품군(Series) 식별자, **Cortex-M3 기반의 STM32F1 시리즈 중 특정 기능 집합을 의미**
- R : **패키지 핀 수** / 핀 그룹 코드
  - ST의 규칙상:
  - C : 48핀급
  - R : 64핀급
  - V : 100핀급
  - Z : 144핀급
- B : **내장 Flash Memory 용량 코드**
  - F1 계열 기준:
  - C : 256KB
  - B : 128KB
  - 8 : 64KB
  - 6 : 32KB
- T : **패키지 타입 코드**,
- - T : LQFP (Low-profile Quad Flat Package)
  - LQFP : 네 변에 핀이 나와 있는 사각 평면 패키지
- 6 : **동작 온도 등급**
  - 6 : 산업용 온도 범위 (-40℃ ~ 85℃)

즉, STM32F103RBT6는 32비트 Cortex-M3 기반, F1 시리즈, 64핀(LQFP), Flash 128KB, 산업용 온도 등급의 MCU를 의미한다.

---

## 핀 역할 설명

### 1. 전원 관련 핀
- VDD / VSS : 디지털 영역
- VDDA / VSSA : 아날로그 영역
- VBAT : 저전력·항상 유지 영역

---

### 2. 클럭 관련 핀
- OSC_IN / OSC_OUT : 고속 외부 크리스탈 연결
- OSC32_IN / OSC32_OUT : 저속 외부 크리스탈 연결

---

### 3. 리셋·부트 관련 핀
NRST(Negative Reset) : 외부 리셋 입력, Low에서 리
BOOT0 / BOOT1 : 부트 모드 선택, 리셋 시점의 핀 상태에 따라 실행 영역 결정
|BOOT1|BOOT0|BOOT MODE|설명 및 용도|
| --- | --- | ------- | ---------- |
|X|0|User Flash Memory|`일반 실행`: 사용자가 작성하여 다운로드한 프로그램이 실행되는 기본 모드.|
|0|1|System Memory|`공장 출하 부트로더`: ST에서 미리 내장해둔 코드를 실행.|
|1|1|Embedded SRAM|`램 실행`: Flash 메모리가 아닌 SRAM에서 직접 코드를 실행.|

---

### 4. GPIO 포트 핀
- 기본적으로 범용 입출력
- 설정에 따라 주변장치 기능으로 다중화(Multiplexing) 됨
- 예:
  - PA9 → USART1_TX
  - PB6 → I2C1_SCL
  - PA5 → SPI1_SCK
- 다음은 실습 키트 소켓에서 제외된 핀들이다.

|핀|기능|제외 이유|
|---|---|---------|
|PA11|USB_DM|USB 디바이스 통신에 필수적인 데이터 라인으로, 일반 GPIO 사용 시 USB 동작이 불가능해짐.|
|PA12|USB_DP|USB 디바이스 통신에 필수적인 데이터 라인으로, 일반 GPIO 사용 시 USB 동작이 불가능해짐.|
|PA13|JTMS / SWDIO|디버그 인터페이스(JTAG/SWD)에 사용되는 전용 핀으로, 시스템 디버깅 및 프로그램 다운로드를 보호하기 위해 제외됨.|
|PA14|JTCK / SWCLK|디버그 인터페이스(JTAG/SWD)에 사용되는 전용 핀으로, 시스템 디버깅 및 프로그램 다운로드를 보호하기 위해 제외됨.|
|PA15|JTDI|디버그 인터페이스(JTAG)에 사용되는 전용 핀으로, 시스템 디버깅 및 복구 기능 보호를 위해 제외됨.|
|B3|JTDO|디버그 인터페이스(JTAG)에 사용되는 전용 핀으로, 시스템 디버깅 및 복구 기능 보호를 위해 제외됨.|
|B4|JNTRST|디버그 인터페이스(JTAG)에 사용되는 전용 핀으로, 디버그 환경의 안정성을 위해 제외됨.|
|C14|OSC32_IN|RTC용 저속 외부 크리스탈 입력 핀으로, 시간 유지 기능 보호를 위해 제외됨.|
|C15|OSC32_OUT|RTC용 저속 외부 크리스탈 출력 핀으로, 시간 유지 기능 보호를 위해 제외됨.|
|D0|OSC_IN|시스템 클럭(HSE) 입력 핀으로, 클럭 안정성 확보를 위해 제외됨.|
|D1|OSC_OUT|시스템 클럭(HSE) 출력 핀으로, 클럭 안정성 확보를 위해 제외됨.|
|D2|x|PROG 신호로 사용되어, 일반 GPIO로 사용하지 않음.|

해당 핀들은 범용 GPIO로 사용 시 시스템의 핵심 기능에 영향을 줄 수 있어, </br> 잘못된 설정으로 인한 복구 불가 상태를 방지하기 위해 물리적으로 차단되어 있다.

---

### 5. TIMER 관련 핀
- CH1~CH4 : 타이머 출력 채널 (PWM 등)
- ETR : 외부 트리거 입력
- CHxN : 상보 PWM 출력

---

### 6. 통신 인터페이스 핀
- USART1/2/3 : TX, RX, CTS, RTS, CK
- SPI1/2 : NSS, SCK, MISO, MOSI
- I2C1/2 : SCL, SDA, SMBA
- CAN : RX, TX
- USB : DM, DP

---

### 7. 디버그 및 시스템 핀
- JTAG(JTMS /JTCK / JTDI / JTDO, JNTRST) : 4~5핀 방식의 표준 디버그 인터페이스

|핀 이름|명칭|역할|
|------|-----|----|
|TMS|Test Mode Select|상태 머신의 상태 변화를 제어.|
|TCK|Test Clock|데이터 송수신을 위한 동기화 클럭을 제공.|
|TDI|Test Data In|테스트 데이터나 명령어를 칩 내부로 삽입.|
|TDO|Test Data Out|칩 내부의 데이터를 외부(PC 등)로 출력.|
|TRST|Test Reset|JTAG 논리 회로를 초기화한다.|

- SWD (SWDIO / SWCLK) : JTAG 대비 핀 수를 줄인(2핀) 직렬 와이어 디버그 방식
- MCO : 내부 클럭을 외부로 출력하여 관찰·동기화
> JTAG는 반도체 내부 회로를 외부에서 제어·관찰·검증하기 위해 정의된 표준 디버그/테스트 인터페이스(IEEE 1149.1)이다. </br>
> 역할
> - 온칩 디버깅 : MCU가 동작하는 동안 내부 레지스터 값이나 메모리 상태를 실시간으로 확인하고, 코드를 한 줄 씩 실행하거나 특정 지점에서 멈추게(Breakpoint) 할 수 있다.
> - 경계 스캔 : 칩의 외부 핀에 실제 물리적 접촉 없이, 내부에 설계된 셀을 통해 칩 간의 연결 상태를 검사한다.
